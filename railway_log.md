2025-10-20T15:49:07.000000000Z [inf]  Starting Container
2025-10-20T15:49:09.264016282Z [inf]  🔌 Port: 8080
2025-10-20T15:49:09.264019384Z [inf]  ✅ Database fully connected and operational
2025-10-20T15:49:09.264029153Z [inf]  🖥️  Host: 0.0.0.0
2025-10-20T15:49:09.264033166Z [inf]  ✅ Database connection validated successfully
2025-10-20T15:49:09.264038949Z [inf]  
2025-10-20T15:49:09.264046675Z [inf]  🔐 Security Configuration:
2025-10-20T15:49:09.264054725Z [inf]  
2025-10-20T15:49:09.264055408Z [inf]    ✅ DATABASE_URL is configured
2025-10-20T15:49:09.264064818Z [inf]    ✅ JWT/SESSION_SECRET is configured
2025-10-20T15:49:09.264065870Z [inf]  ✅ startServer() invocation completed successfully
2025-10-20T15:49:09.264074799Z [inf]  
2025-10-20T15:49:09.264076771Z [inf]  ✅ Database connection established
2025-10-20T15:49:09.264085598Z [inf]  🌐 Starting HTTP server...
2025-10-20T15:49:09.264086049Z [inf]  ✅ Database connection established
2025-10-20T15:49:09.264097745Z [inf]     Binding to: 0.0.0.0:8080
2025-10-20T15:49:09.264099577Z [inf]  ✅ Database connection successful
2025-10-20T15:49:09.264100357Z [inf]  📊 Features: Three-Engine AI, Multi-Provider Consensus
2025-10-20T15:49:09.264103501Z [inf]  ═══════════════════════════════════════════════════════════
2025-10-20T15:49:09.264109573Z [inf]  🔍 Database connection attempt 1/2...
2025-10-20T15:49:09.264120130Z [inf]  🔍 Testing database connection...
2025-10-20T15:49:09.264124642Z [inf]  ═══════════════════════════════════════════════════════════
2025-10-20T15:49:09.264127880Z [inf]  🔒 Security: CORS, Helmet, Rate Limiting
2025-10-20T15:49:09.264132644Z [inf]  ✅ MIZAN PLATFORM SERVER ONLINE
2025-10-20T15:49:09.264134281Z [inf]  
2025-10-20T15:49:09.264142411Z [inf]  🌐 Server: http://0.0.0.0:8080
2025-10-20T15:49:09.264147943Z [inf]  🗄️  Database: Testing connection in background...
2025-10-20T15:49:09.264158193Z [inf]  🏥 Health: http://0.0.0.0:8080/health
2025-10-20T15:49:09.264162956Z [inf]  ═══════════════════════════════════════════════════════════
2025-10-20T15:49:09.264594157Z [inf]  ========================================
2025-10-20T15:49:09.264599578Z [inf]  🚀 Mizan Server Process Starting...
2025-10-20T15:49:09.264604493Z [inf]  📅 Timestamp: 2025-10-20T15:49:07.742Z
2025-10-20T15:49:09.264609662Z [inf]  🌍 Node Version: v20.19.5
2025-10-20T15:49:09.264617117Z [inf]  📦 Environment: production
2025-10-20T15:49:09.264621784Z [inf]  🔄 Deployment Version: 7df2998 - Enhanced error logging
2025-10-20T15:49:09.264627460Z [inf]  ========================================
2025-10-20T15:49:09.264633128Z [inf]  ⚙️  Environment variables ready (injected by platform)
2025-10-20T15:49:09.264637918Z [inf]  📊 Environment Check:
2025-10-20T15:49:09.264642424Z [inf]    - PORT: 8080
2025-10-20T15:49:09.264646478Z [inf]    - DATABASE_URL: ✅ SET
2025-10-20T15:49:09.264650929Z [inf]    - SESSION_SECRET: ⚠️  NOT SET
2025-10-20T15:49:09.264655801Z [inf]    - JWT_SECRET: ✅ SET
2025-10-20T15:49:09.264661464Z [inf]  📚 Loading database module...
2025-10-20T15:49:09.264666941Z [inf]  ✅ Database module loaded
2025-10-20T15:49:09.264672364Z [inf]  💡 Configured Port: 8080
2025-10-20T15:49:09.264677599Z [inf]  💡 Configured Host: 0.0.0.0
2025-10-20T15:49:09.264682959Z [inf]  🌐 CORS configured with dynamic origin checking
2025-10-20T15:49:09.264709222Z [inf]  ✅ Allowed origins (static): [
2025-10-20T15:49:09.264713943Z [inf]    'http://localhost:3000',
2025-10-20T15:49:09.264718651Z [inf]    'http://localhost:3001',
2025-10-20T15:49:09.264724453Z [inf]    'https://mizan.work',
2025-10-20T15:49:09.264730396Z [inf]    'https://www.mizan.work',
2025-10-20T15:49:09.264735216Z [inf]    'https://api.mizan.work',
2025-10-20T15:49:09.264740722Z [inf]    'https://mizan-platform-final.vercel.app',
2025-10-20T15:49:09.264778427Z [inf]    'https://mizan-frontend-ten.vercel.app',
2025-10-20T15:49:09.264784643Z [inf]    'https://mizan-api.railway.app'
2025-10-20T15:49:09.264791306Z [inf]  ]
2025-10-20T15:49:09.264797075Z [inf]  ✅ Dynamic patterns: *.vercel.app, *.railway.app
2025-10-20T15:49:09.264804435Z [inf]  🔧 CLIENT_URL environment variable: https://mizan.work
2025-10-20T15:49:09.264811578Z [inf]  🔧 FRONTEND_URL environment variable: https://mizan.work
2025-10-20T15:49:09.264817320Z [inf]  🎬 Invoking startServer() function...
2025-10-20T15:49:09.264822302Z [inf]  
2025-10-20T15:49:09.264827266Z [inf]  ═══════════════════════════════════════════════════════════
2025-10-20T15:49:09.264831805Z [inf]  🚀 STARTING MIZAN PLATFORM SERVER v2.0.0
2025-10-20T15:49:09.264836724Z [inf]  ═══════════════════════════════════════════════════════════
2025-10-20T15:49:09.264841032Z [inf]  📍 Environment: production
2025-10-20T15:49:09.350749629Z [inf]  🏥 Health check requested. Reporting current status:
2025-10-20T15:49:09.350757821Z [inf]    - Server Status: running
2025-10-20T15:49:09.350764629Z [inf]    - Database Status: connected
2025-10-20T15:49:09.350771588Z [inf]    - DATABASE_URL: Set (hidden)
2025-10-20T15:49:39.348488867Z [inf]  📤 Database connection removed from pool
2025-10-20T15:49:39.348494347Z [inf]  📤 Database connection removed from pool
2025-10-20T15:49:42.311552843Z [inf]  ✅ Database connection established
2025-10-20T15:49:42.311564096Z [inf]  ✅ Database connection established
2025-10-20T15:49:42.311572132Z [inf]  ✅ Converted tenant ID: "99c97d43-d075-4ebe-b719-24511cd287d6" -> 580118854 (type: number)
2025-10-20T15:49:42.311580670Z [inf]  ✅ Converted tenant ID: "1ce32fe3-6788-44e9-82c5-fb799a0501ab" -> 484650980 (type: number)
2025-10-20T15:49:42.311592988Z [inf]  ✅ Database connection established
2025-10-20T15:49:42.311598203Z [inf]  Fetching tenants for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:49:42.311602910Z [inf]  Database connection verified for tenants
2025-10-20T15:49:42.311608121Z [inf]  Fetched tenants: 3
2025-10-20T15:49:42.311615215Z [inf]  ✅ Converted tenant ID: "superadmin-tenant" -> 1 (type: number)
2025-10-20T15:49:42.311624587Z [inf]  📥 [Request] {
2025-10-20T15:49:42.311635279Z [inf]    method: 'GET',
2025-10-20T15:49:42.311641158Z [inf]    path: '/api/superadmin/tenants',
2025-10-20T15:49:42.311646831Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:49:42.311652981Z [inf]    hasAuth: true,
2025-10-20T15:49:42.311660318Z [inf]    contentType: 'application/json'
2025-10-20T15:49:42.311666403Z [inf]  }
2025-10-20T15:49:44.567471548Z [inf]  📥 [Request] {
2025-10-20T15:49:44.567480844Z [inf]    method: 'GET',
2025-10-20T15:49:44.567486575Z [inf]    path: '/api/superadmin/stats',
2025-10-20T15:49:44.567492905Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:49:44.567498870Z [inf]    hasAuth: true,
2025-10-20T15:49:44.567505207Z [inf]    contentType: 'application/json'
2025-10-20T15:49:44.567511119Z [inf]  }
2025-10-20T15:49:44.570992558Z [inf]  Fetching superadmin stats for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:49:44.575984736Z [inf]  Database connection verified
2025-10-20T15:49:44.579476292Z [inf]  Fetched tenants: 3
2025-10-20T15:49:44.582504270Z [inf]  Fetched users: 23
2025-10-20T15:49:44.582514034Z [inf]  Stats calculated successfully: {
2025-10-20T15:49:44.582519972Z [inf]    totalTenants: 3,
2025-10-20T15:49:44.582532817Z [inf]    totalUsers: 23,
2025-10-20T15:49:44.582538118Z [inf]    activeTenants: 3,
2025-10-20T15:49:44.582545121Z [inf]    totalRevenue: 1220,
2025-10-20T15:49:44.582550510Z [inf]    monthlyGrowth: 8.7,
2025-10-20T15:49:44.582556126Z [inf]    totalAnalyses: 6
2025-10-20T15:49:44.582562962Z [inf]  }
2025-10-20T15:49:44.585206862Z [inf]  📥 [Request] {
2025-10-20T15:49:44.585214464Z [inf]    method: 'GET',
2025-10-20T15:49:44.585221512Z [inf]    path: '/api/superadmin/activity',
2025-10-20T15:49:44.585226706Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:49:44.585231951Z [inf]    hasAuth: true,
2025-10-20T15:49:44.585237019Z [inf]    contentType: 'application/json'
2025-10-20T15:49:44.585242473Z [inf]  }
2025-10-20T15:49:44.587601961Z [inf]  📥 [Request] {
2025-10-20T15:49:44.587608303Z [inf]    method: 'GET',
2025-10-20T15:49:44.587616224Z [inf]    path: '/api/superadmin/revenue',
2025-10-20T15:49:44.587622526Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:49:44.587629654Z [inf]    hasAuth: true,
2025-10-20T15:49:44.587635665Z [inf]    contentType: 'application/json'
2025-10-20T15:49:44.587641972Z [inf]  }
2025-10-20T15:49:44.593678544Z [inf]  📥 [Request] {
2025-10-20T15:49:44.593683042Z [inf]    method: 'GET',
2025-10-20T15:49:44.593688481Z [inf]    path: '/api/superadmin/tenants',
2025-10-20T15:49:44.593693884Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:49:44.593698417Z [inf]    hasAuth: true,
2025-10-20T15:49:44.593703726Z [inf]    contentType: 'application/json'
2025-10-20T15:49:44.593708415Z [inf]  }
2025-10-20T15:49:44.596416476Z [inf]  Fetching activity data for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:49:44.599722312Z [inf]  Database connection verified for activity
2025-10-20T15:49:44.602307920Z [inf]  Fetching revenue data for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:49:44.602315611Z [inf]  Fetching tenants for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:49:44.602320527Z [inf]  Fetched recent tenants: 3
2025-10-20T15:49:44.605375499Z [inf]  Activity: User amanda@company.com TenantID: 1ce32fe3-6788-44e9-82c5-fb799a0501ab -> 484650980
2025-10-20T15:49:44.605389550Z [inf]  Activity: User robert@company.com TenantID: 1ce32fe3-6788-44e9-82c5-fb799a0501ab -> 484650980
2025-10-20T15:49:44.605389591Z [inf]  Database connection verified for revenue
2025-10-20T15:49:44.605400605Z [inf]  Database connection verified for tenants
2025-10-20T15:49:44.605406744Z [inf]  Fetched recent users: 5
2025-10-20T15:49:44.605412630Z [inf]  Activity: Tenant test ID: 99c97d43-d075-4ebe-b719-24511cd287d6 -> 580118854
2025-10-20T15:49:44.605419127Z [inf]  Activity: Tenant TEst ID: 1ce32fe3-6788-44e9-82c5-fb799a0501ab -> 484650980
2025-10-20T15:49:44.605425616Z [inf]  Activity: Tenant Mizan Superadmin ID: superadmin-tenant -> 1
2025-10-20T15:49:44.605431611Z [inf]  Activity: User chris@company.com TenantID: 1ce32fe3-6788-44e9-82c5-fb799a0501ab -> 484650980
2025-10-20T15:49:44.605437956Z [inf]  Activity: User lisa@company.com TenantID: 1ce32fe3-6788-44e9-82c5-fb799a0501ab -> 484650980
2025-10-20T15:49:44.605443530Z [inf]  Activity: User james@company.com TenantID: 1ce32fe3-6788-44e9-82c5-fb799a0501ab -> 484650980
2025-10-20T15:49:44.610035909Z [inf]  Fetched all tenants: 3
2025-10-20T15:49:44.635999900Z [inf]  Fetched tenants: 3
2025-10-20T15:49:44.639315405Z [inf]  ✅ Converted tenant ID: "superadmin-tenant" -> 1 (type: number)
2025-10-20T15:49:44.639325238Z [inf]  ✅ Converted tenant ID: "99c97d43-d075-4ebe-b719-24511cd287d6" -> 580118854 (type: number)
2025-10-20T15:49:44.639331839Z [inf]  ✅ Converted tenant ID: "1ce32fe3-6788-44e9-82c5-fb799a0501ab" -> 484650980 (type: number)
2025-10-20T15:49:45.357445323Z [inf]  📥 [Request] {
2025-10-20T15:49:45.357454437Z [inf]    method: 'GET',
2025-10-20T15:49:45.357460887Z [inf]    path: '/api/superadmin/tenants',
2025-10-20T15:49:45.357466658Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:49:45.357472328Z [inf]    hasAuth: true,
2025-10-20T15:49:45.357478446Z [inf]    contentType: 'application/json'
2025-10-20T15:49:45.357484189Z [inf]  }
2025-10-20T15:49:45.365022064Z [inf]  Fetching tenants for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:49:45.368322957Z [inf]  Database connection verified for tenants
2025-10-20T15:49:45.383181240Z [inf]  Fetched tenants: 3
2025-10-20T15:49:45.383189576Z [inf]  ✅ Converted tenant ID: "superadmin-tenant" -> 1 (type: number)
2025-10-20T15:49:45.383197218Z [inf]  ✅ Converted tenant ID: "1ce32fe3-6788-44e9-82c5-fb799a0501ab" -> 484650980 (type: number)
2025-10-20T15:49:45.383204881Z [inf]  ✅ Converted tenant ID: "99c97d43-d075-4ebe-b719-24511cd287d6" -> 580118854 (type: number)
2025-10-20T15:49:46.781212695Z [inf]  📥 [Request] {
2025-10-20T15:49:46.781223814Z [inf]    method: 'GET',
2025-10-20T15:49:46.781231283Z [inf]    path: '/api/demo/requests',
2025-10-20T15:49:46.781238699Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:49:46.781244705Z [inf]    hasAuth: true,
2025-10-20T15:49:46.781250866Z [inf]    contentType: 'none'
2025-10-20T15:49:46.781256951Z [inf]  }
2025-10-20T15:49:47.427029748Z [err]  Get demo requests error: error: column "notes" does not exist
2025-10-20T15:49:47.427036265Z [err]      at /app/node_modules/pg-pool/index.js:45:11
2025-10-20T15:49:47.427042608Z [err]      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
2025-10-20T15:49:47.427048722Z [err]      at async /app/node_modules/drizzle-orm/node-postgres/session.cjs:82:22
2025-10-20T15:49:47.427055165Z [err]      at async /app/dist/src/routes/demo.js:191:26 {
2025-10-20T15:49:47.427061481Z [err]    length: 106,
2025-10-20T15:49:47.427068756Z [err]    severity: 'ERROR',
2025-10-20T15:49:47.427074344Z [err]    code: '42703',
2025-10-20T15:49:47.428435065Z [err]    detail: undefined,
2025-10-20T15:49:47.428447487Z [err]    hint: undefined,
2025-10-20T15:49:47.428458140Z [err]    position: '260',
2025-10-20T15:49:47.428470301Z [err]    internalPosition: undefined,
2025-10-20T15:49:47.428477243Z [err]    internalQuery: undefined,
2025-10-20T15:49:47.428483728Z [err]    where: undefined,
2025-10-20T15:49:47.428490225Z [err]    schema: undefined,
2025-10-20T15:49:47.428497243Z [err]    table: undefined,
2025-10-20T15:49:47.428502606Z [err]    column: undefined,
2025-10-20T15:49:47.428510496Z [err]    dataType: undefined,
2025-10-20T15:49:47.428516770Z [err]    constraint: undefined,
2025-10-20T15:49:47.428523001Z [err]    file: 'parse_relation.c',
2025-10-20T15:49:47.428529216Z [err]    line: '3716',
2025-10-20T15:49:47.428535314Z [err]    routine: 'errorMissingColumn'
2025-10-20T15:49:47.428541456Z [err]  }
2025-10-20T15:49:47.428548572Z [inf]  📤 Database connection removed from pool
2025-10-20T15:50:17.417610757Z [inf]    path: '/api/superadmin/analytics/api',
2025-10-20T15:50:17.417614105Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:50:17.417621825Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:50:17.417628188Z [inf]    hasAuth: true,
2025-10-20T15:50:17.417631175Z [inf]    hasAuth: true,
2025-10-20T15:50:17.417637925Z [inf]    contentType: 'application/json'
2025-10-20T15:50:17.417639760Z [inf]    contentType: 'application/json'
2025-10-20T15:50:17.417647543Z [inf]  }
2025-10-20T15:50:17.417647648Z [inf]  }
2025-10-20T15:50:17.417654064Z [inf]  📥 [Request] {
2025-10-20T15:50:17.417658721Z [inf]    method: 'GET',
2025-10-20T15:50:17.417665426Z [inf]    path: '/api/superadmin/analytics/agents',
2025-10-20T15:50:17.417665677Z [inf]  📤 Database connection removed from pool
2025-10-20T15:50:17.417672572Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:50:17.417674735Z [inf]  📤 Database connection removed from pool
2025-10-20T15:50:17.417679532Z [inf]    hasAuth: true,
2025-10-20T15:50:17.417683452Z [inf]  📥 [Request] {
2025-10-20T15:50:17.417687697Z [inf]    contentType: 'application/json'
2025-10-20T15:50:17.417692273Z [inf]    method: 'GET',
2025-10-20T15:50:17.417695518Z [inf]  }
2025-10-20T15:50:17.417702208Z [inf]    path: '/api/superadmin/analytics/usage',
2025-10-20T15:50:17.417702338Z [inf]  📥 [Request] {
2025-10-20T15:50:17.417709293Z [inf]    method: 'GET',
2025-10-20T15:50:17.417712003Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:50:17.417716615Z [inf]    path: '/api/superadmin/analytics/performance',
2025-10-20T15:50:17.417720967Z [inf]    hasAuth: true,
2025-10-20T15:50:17.417727706Z [inf]    contentType: 'application/json'
2025-10-20T15:50:17.417736690Z [inf]  }
2025-10-20T15:50:17.417742579Z [inf]  📥 [Request] {
2025-10-20T15:50:17.417748028Z [inf]    method: 'GET',
2025-10-20T15:50:17.419113755Z [inf]  ✅ Database connection established
2025-10-20T15:50:17.419122756Z [inf]  ✅ Database connection established
2025-10-20T15:50:17.419128938Z [inf]  ✅ Database connection established
2025-10-20T15:50:17.419134394Z [inf]  ✅ Database connection established
2025-10-20T15:50:36.963025622Z [inf]  📥 [Request] {
2025-10-20T15:50:36.963032687Z [inf]    method: 'GET',
2025-10-20T15:50:36.963040096Z [inf]    path: '/api/superadmin/tenants',
2025-10-20T15:50:36.963046857Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:50:36.963053608Z [inf]    hasAuth: true,
2025-10-20T15:50:36.963060958Z [inf]    contentType: 'application/json'
2025-10-20T15:50:36.963068718Z [inf]  }
2025-10-20T15:50:36.963075378Z [inf]  Fetching tenants for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:50:36.963082346Z [inf]  Database connection verified for tenants
2025-10-20T15:50:36.963089471Z [inf]  Fetched tenants: 3
2025-10-20T15:50:36.963096356Z [inf]  ✅ Converted tenant ID: "99c97d43-d075-4ebe-b719-24511cd287d6" -> 580118854 (type: number)
2025-10-20T15:50:36.963103388Z [inf]  ✅ Converted tenant ID: "1ce32fe3-6788-44e9-82c5-fb799a0501ab" -> 484650980 (type: number)
2025-10-20T15:50:36.963109751Z [inf]  ✅ Converted tenant ID: "superadmin-tenant" -> 1 (type: number)
2025-10-20T15:50:40.941179564Z [inf]  📥 [Request] {
2025-10-20T15:50:40.941185780Z [inf]    method: 'POST',
2025-10-20T15:50:40.941191336Z [inf]    path: '/api/upload/org-chart',
2025-10-20T15:50:40.941197029Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:50:40.941201814Z [inf]    hasAuth: true,
2025-10-20T15:50:40.941207224Z [inf]    contentType: 'multipart/form-data; boundary=----WebKitFormBoundary613V8LxNk3niCYiF'
2025-10-20T15:50:40.941212352Z [inf]  }
2025-10-20T15:50:46.512098618Z [inf]  📤 Database connection removed from pool
2025-10-20T15:51:06.076982766Z [err]  Provider gemini confidence too low: 0.5999999999999999
2025-10-20T15:51:06.076987659Z [inf]  📤 Database connection removed from pool
2025-10-20T15:51:06.076991968Z [inf]  📤 Database connection removed from pool
2025-10-20T15:51:07.597594709Z [err]  Provider mistral confidence too low: 0.5999999999999999
2025-10-20T15:51:10.980353022Z [err]  Provider openai confidence too low: 0.7
2025-10-20T15:51:11.150570966Z [inf]  📤 Database connection removed from pool
2025-10-20T15:51:18.629259931Z [err]  Provider anthropic confidence too low: 0.5999999999999999
2025-10-20T15:51:48.236105550Z [inf]  ✅ Database connection established
2025-10-20T15:51:48.236111834Z [inf]  📊 Fetching organization structure for tenant: 484650980
2025-10-20T15:51:48.236118020Z [inf]  ✅ Database connection established
2025-10-20T15:51:48.236123528Z [err]  ❌ No organization structure found for tenant: 484650980
2025-10-20T15:51:48.236128425Z [err]  💡 User action required: Upload an organization chart before running structure analysis
2025-10-20T15:51:48.236133313Z [err]  structure analysis failed: Error: No organization structure found for tenant. Please upload an organization chart first.
2025-10-20T15:51:48.236139165Z [err]      at StructureAgent.processData (/app/dist/src/services/agents/structure-agent.js:320:19)
2025-10-20T15:51:48.236144544Z [err]      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
2025-10-20T15:51:48.236149991Z [err]      at async StructureAgent.runDataEngine (/app/dist/src/services/agents/base/three-engine-agent.js:77:31)
2025-10-20T15:51:48.236155183Z [err]      at async StructureAgent.analyze (/app/dist/src/services/agents/base/three-engine-agent.js:34:32)
2025-10-20T15:51:48.236160415Z [err]      at async StructureAgent.analyzeOrganizationStructure (/app/dist/src/services/agents/structure-agent.js:39:24)
2025-10-20T15:51:48.236165569Z [err]      at async handleOrgChartUpload (/app/dist/src/routes/upload.js:375:24)
2025-10-20T15:51:48.236170338Z [err]  Save org structure failed: Error: No organization structure found for tenant. Please upload an organization chart first.
2025-10-20T15:51:48.236173842Z [err]      at StructureAgent.processData (/app/dist/src/services/agents/structure-agent.js:320:19)
2025-10-20T15:51:48.236177683Z [err]      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
2025-10-20T15:51:48.236184547Z [err]      at async StructureAgent.runDataEngine (/app/dist/src/services/agents/base/three-engine-agent.js:77:31)
2025-10-20T15:51:48.239831641Z [err]      at async StructureAgent.analyze (/app/dist/src/services/agents/base/three-engine-agent.js:34:32)
2025-10-20T15:51:48.239840546Z [err]      at async StructureAgent.analyzeOrganizationStructure (/app/dist/src/services/agents/structure-agent.js:39:24)
2025-10-20T15:51:48.239871052Z [err]      at async handleOrgChartUpload (/app/dist/src/routes/upload.js:375:24)
2025-10-20T15:51:48.239878359Z [err]  Error stack: Error: No organization structure found for tenant. Please upload an organization chart first.
2025-10-20T15:51:48.239890441Z [err]      at StructureAgent.processData (/app/dist/src/services/agents/structure-agent.js:320:19)
2025-10-20T15:51:48.239897631Z [err]      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
2025-10-20T15:51:48.239903910Z [err]      at async StructureAgent.runDataEngine (/app/dist/src/services/agents/base/three-engine-agent.js:77:31)
2025-10-20T15:51:48.239911142Z [err]      at async StructureAgent.analyze (/app/dist/src/services/agents/base/three-engine-agent.js:34:32)
2025-10-20T15:51:48.239918528Z [err]      at async StructureAgent.analyzeOrganizationStructure (/app/dist/src/services/agents/structure-agent.js:39:24)
2025-10-20T15:51:48.239924894Z [err]      at async handleOrgChartUpload (/app/dist/src/routes/upload.js:375:24)
2025-10-20T15:52:18.239499438Z [inf]  📤 Database connection removed from pool
2025-10-20T15:52:19.118649471Z [inf]  📥 [Request] {
2025-10-20T15:52:19.118662110Z [inf]    method: 'GET',
2025-10-20T15:52:19.118669134Z [inf]    path: '/api/superadmin/tenants',
2025-10-20T15:52:19.118676543Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:52:19.118684583Z [inf]    hasAuth: true,
2025-10-20T15:52:19.118694889Z [inf]    contentType: 'application/json'
2025-10-20T15:52:19.118702211Z [inf]  }
2025-10-20T15:52:19.118709438Z [inf]  ✅ Database connection established
2025-10-20T15:52:19.118717337Z [inf]  Fetching tenants for user: a8b36994-723d-45b8-a5bc-d7eea4f2bc18
2025-10-20T15:52:19.118726296Z [inf]  Database connection verified for tenants
2025-10-20T15:52:19.118734614Z [inf]  Fetched tenants: 3
2025-10-20T15:52:19.118741699Z [inf]  ✅ Converted tenant ID: "superadmin-tenant" -> 1 (type: number)
2025-10-20T15:52:19.118749837Z [inf]  ✅ Database connection established
2025-10-20T15:52:19.118758238Z [inf]  ✅ Database connection established
2025-10-20T15:52:19.118766812Z [inf]  ✅ Converted tenant ID: "1ce32fe3-6788-44e9-82c5-fb799a0501ab" -> 484650980 (type: number)
2025-10-20T15:52:19.118775908Z [inf]  ✅ Converted tenant ID: "99c97d43-d075-4ebe-b719-24511cd287d6" -> 580118854 (type: number)
2025-10-20T15:52:26.146075411Z [err]    severity: 'ERROR',
2025-10-20T15:52:26.146089372Z [err]    code: '42703',
2025-10-20T15:52:26.146111036Z [err]      at /app/node_modules/pg-pool/index.js:45:11
2025-10-20T15:52:26.146120357Z [err]      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
2025-10-20T15:52:26.146142287Z [err]      at async /app/node_modules/drizzle-orm/node-postgres/session.cjs:82:22
2025-10-20T15:52:26.146143213Z [inf]  🎯 COMPANY REPORT - Endpoint hit for tenant: 484650980
2025-10-20T15:52:26.146155730Z [inf]  📥 [Request] {
2025-10-20T15:52:26.146157648Z [inf]    hasAuth: true,
2025-10-20T15:52:26.146158607Z [err]      at async /app/dist/src/routes/culture-assessment.js:616:29 {
2025-10-20T15:52:26.146171739Z [inf]  🎯 COMPANY REPORT - No cache, generating new report...
2025-10-20T15:52:26.146176119Z [err]    length: 137,
2025-10-20T15:52:26.146177294Z [inf]    contentType: 'none'
2025-10-20T15:52:26.146178342Z [inf]    method: 'GET',
2025-10-20T15:52:26.146192502Z [err]  Error generating company report: error: column cultureAssessments.additional_comments does not exist
2025-10-20T15:52:26.146198169Z [inf]  }
2025-10-20T15:52:26.146198631Z [inf]    path: '/api/culture-assessment/report/company',
2025-10-20T15:52:26.146213274Z [inf]    origin: 'https://www.mizan.work',
2025-10-20T15:52:26.146257850Z [err]    detail: undefined,
2025-10-20T15:52:26.146268821Z [err]    hint: undefined,
2025-10-20T15:52:26.146276714Z [err]    position: '333',
2025-10-20T15:52:26.146286784Z [err]    internalPosition: undefined,
2025-10-20T15:52:26.146296297Z [err]    internalQuery: undefined,
2025-10-20T15:52:26.146304329Z [err]    where: undefined,
2025-10-20T15:52:26.146313423Z [err]    schema: undefined,
2025-10-20T15:52:26.146324570Z [err]    table: undefined,
2025-10-20T15:52:26.146333374Z [err]    column: undefined,
2025-10-20T15:52:26.146349098Z [err]    dataType: undefined,
2025-10-20T15:52:26.150800025Z [err]    constraint: undefined,
2025-10-20T15:52:26.150808575Z [err]    file: 'parse_relation.c',
2025-10-20T15:52:26.150813610Z [err]    line: '3716',
2025-10-20T15:52:26.150818251Z [err]    routine: 'errorMissingColumn'
2025-10-20T15:52:26.150823888Z [err]  }
2025-10-20T15:52:26.150828505Z [inf]  📤 Database connection removed from pool